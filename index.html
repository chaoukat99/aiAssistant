<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OMAR CHAOUKAT - AI Assistant</title>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #4A90E2 0%, #2C3E50 100%);
            min-height: 80vh;
            overflow: hidden;
            position: relative;
        }
        ul.awesome-list {
  list-style: none;
  padding: 0;
  margin: 0;
  max-width: 600px;
  margin: auto;
}

ul.awesome-list li {
  background: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(12px);
  border-radius: 14px;
  padding: 18px 20px;
  margin-bottom: 15px;
  box-shadow: 0 5px 14px rgba(0, 0, 0, 0.08);
  display: flex;
  align-items: center;
  gap: 14px;
  border-left: 6px solid transparent;
  transition: 0.25s ease;
}

ul.awesome-list li:hover {
  transform: translateY(-3px);
  border-left: 6px solid #6366f1;
  box-shadow: 0 7px 20px rgba(0, 0, 0, 0.12);
}

ul.awesome-list li .icon {
  width: 42px;
  height: 42px;
  background: linear-gradient(135deg, #6366f1, #8b5cf6);
  border-radius: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  font-size: 20px;
  flex-shrink: 0;
}

ul.awesome-list li .text {
  font-size: 17px;
  font-weight: 500;
  color: #333;
}

        /* Avatar Container */
        .avatar-container {
            position: absolute;
            width: 150px;
            height: 150px;
            transition: opacity 0.5s ease, visibility 0.5s ease, transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55), left 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55), top 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: scale(0.5);
        }

        .avatar-container.show {
            opacity: 1;
            visibility: visible;
            transform: scale(1);
        }

        .avatar {
            width: 100%;
            height: 100%;
            position: relative;
            cursor: grab;
        }

        .avatar:active {
            cursor: grabbing;
        }

        .avatar-container.dragging {
            transition: none !important;
        }

        /* Avatar Circle */
        .avatar-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, #E8F4F8 0%, #B8D4E8 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .avatar-circle::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        /* Avatar Face */
        .avatar-face {
            font-size: 60px;
            z-index: 1;
            animation: idle 2s ease-in-out infinite;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .avatar-face img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        @keyframes idle {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.05) rotate(5deg); }
        }

        /* Talking Animation */
        .avatar-talking .avatar-face {
            animation: talking 0.3s ease-in-out infinite;
        }

        @keyframes talking {
            0%, 100% { transform: scale(1) translateY(0); }
            25% { transform: scale(1.1) translateY(-5px); }
            75% { transform: scale(0.95) translateY(5px); }
        }

        .avatar-talking .avatar-circle {
            animation: pulse 0.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3); }
            50% { transform: scale(1.1); box-shadow: 0 15px 50px rgba(74, 144, 226, 0.5); }
        }

        /* Voice Waves */
        .voice-waves {
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            gap: 5px;
        }

        .avatar-talking .voice-waves {
            display: flex;
        }

        .wave {
            width: 4px;
            height: 20px;
            background: #fff;
            border-radius: 2px;
            animation: wave 0.5s ease-in-out infinite;
        }

        .wave:nth-child(2) { animation-delay: 0.1s; }
        .wave:nth-child(3) { animation-delay: 0.2s; }
        .wave:nth-child(4) { animation-delay: 0.3s; }
        .wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes wave {
            0%, 100% { height: 10px; }
            50% { height: 30px; }
        }

        /* Chat Container */
        .chat-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 450px;
            height: 650px;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 25px;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4), 0 0 1px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: fadeInScale 0.5s ease-out;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        /* Chat Header */
        .chat-header {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
            padding: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .chat-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            animation: headerShine 4s infinite;
        }

        @keyframes headerShine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .chat-header-avatar {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.25);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            z-index: 1;
        }

        .chat-header-info {
            z-index: 1;
        }

        .chat-header-info h2 {
            font-size: 20px;
            margin-bottom: 5px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .chat-header-info p {
            font-size: 13px;
            opacity: 0.95;
            font-weight: 300;
        }

        /* Chat Messages */
        .chat-messages {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 18px;
            background: linear-gradient(to bottom, #fafafa 0%, #ffffff 100%);
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            border-radius: 10px;
            border: 2px solid #fafafa;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #3A7BC8 0%, #2C6BA8 100%);
        }

        .message {
            display: flex;
            gap: 10px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 38px;
            height: 38px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .message.assistant .message-avatar {
            background: linear-gradient(135deg, #B0BEC5 0%, #78909C 100%);
        }

        .message.user .message-avatar {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
        }

        .message-content {
            max-width: 75%;
            padding: 14px 18px;
            border-radius: 20px;
            font-size: 15px;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            word-wrap: break-word;
        }

        .message.assistant .message-content {
            background: linear-gradient(135deg, #ffffff 0%, #f5f5f5 100%);
            color: #2c3e50;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        .typing-indicator {
            display: flex;
            gap: 5px;
            padding: 12px 16px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #999;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { opacity: 0.3; transform: translateY(0); }
            30% { opacity: 1; transform: translateY(-10px); }
        }

        /* Chat Input */
        .chat-input-container {
            padding: 25px;
            background: linear-gradient(to bottom, #ffffff 0%, #f8f9fa 100%);
            border-top: 1px solid rgba(0, 0, 0, 0.08);
            display: flex;
            gap: 12px;
            align-items: center;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.05);
        }

        /* File upload button (next to send/audio) */
        .file-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #F59E0B 0%, #F97316 100%);
            color: white;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
            transition: all 0.25s ease;
        }

        .file-btn:hover { transform: translateY(-2px) scale(1.05); }
        .file-input-hidden { display: none; }

        .send-btn, .audio-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }

        .send-btn::before, .audio-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .send-btn:hover::before, .audio-btn:hover::before {
            width: 100px;
            height: 100px;
        }

        .send-btn {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
        }

        .audio-btn {
            background: linear-gradient(135deg, #90A4AE 0%, #78909C 100%);
            color: white;
        }

        .send-btn:hover, .audio-btn:hover {
            transform: translateY(-2px) scale(1.08);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        }

        .send-btn:active, .audio-btn:active {
            transform: translateY(0) scale(0.95);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        /* Audio Recording */
        .audio-btn.recording {
            animation: recordPulse 1s infinite;
        }

        @keyframes recordPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(144, 164, 174, 0.7); }
            50% { box-shadow: 0 0 0 15px rgba(144, 164, 174, 0); }
        }

        /* Logo Top Left */
        .logo-container {
            position: fixed;
            top: 30px;
            left: 30px;
            z-index: 1000;
            animation: fadeInLeft 0.8s ease-out;
        }

        @keyframes fadeInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .logo:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }

        .logo-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.4);
            animation: logoPulse 3s ease-in-out infinite;
            overflow: hidden;
        }

        .logo-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        @keyframes logoPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .logo-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .logo-text .name {
            font-size: 18px;
            font-weight: 700;
            color: white;
            letter-spacing: 1px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
        }

        .logo-text .tagline {
            font-size: 11px;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: 0.5px;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);
        }

        /* Welcome Message */
        .welcome-message {
            position: absolute;
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: white;
            z-index: 1;
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .welcome-message h1 {
            font-size: 56px;
            margin-bottom: 15px;
            text-shadow: 3px 3px 15px rgba(0, 0, 0, 0.4);
            font-weight: 700;
            letter-spacing: 2px;
        }

        .welcome-message p {
            font-size: 22px;
            opacity: 0.95;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
            font-weight: 300;
        }

        /* Particles Background */
        .particle {
            position: absolute;
            width: 5px;
            height: 5px;
            background: white;
            border-radius: 50%;
            opacity: 0.6;
            animation: float 15s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); }
            25% { transform: translateY(-100px) translateX(50px); }
            50% { transform: translateY(-50px) translateX(-50px); }
            75% { transform: translateY(-150px) translateX(100px); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .chat-container {
                width: 90%;
                height: 75vh;
                border-radius: 20px;
            }

            .chat-header {
                padding: 18px;
            }

            .chat-messages {
                padding: 18px;
                gap: 12px;
            }

            .chat-input-container {
                padding: 15px;
            }

            .welcome-message h1 {
                font-size: 36px;
            }

            .welcome-message p {
                font-size: 16px;
            }

            .avatar-container {
                width: 100px;
                height: 100px;
            }

            .avatar-face {
                font-size: 40px;
            }

            .logo-container {
                top: 15px;
                left: 15px;
            }

            .logo {
                padding: 10px 15px;
                gap: 8px;
            }

            .logo-icon {
                width: 35px;
                height: 35px;
                font-size: 20px;
            }

            .logo-text .name {
                font-size: 14px;
            }

            .logo-text .tagline {
                font-size: 9px;
            }
        }

        @media (max-width: 480px) {
            .chat-container {
                width: 98%;
                height: 70vh;
                border-radius: 15px;
            }

            .chat-header {
                padding: 15px;
            }

            .chat-header-avatar {
                width: 45px;
                height: 45px;
                font-size: 22px;
            }

            .chat-header-info h2 {
                font-size: 16px;
            }

            .chat-header-info p {
                font-size: 12px;
            }

            .chat-messages {
                padding: 12px;
                gap: 10px;
            }

            .message-content {
                max-width: 85%;
                padding: 10px 14px;
                font-size: 13px;
            }

            .chat-input-container {
                padding: 12px;
                gap: 8px;
            }

            .chat-input {
                padding: 10px 14px;
                font-size: 13px;
                border-radius: 25px;
            }

            .send-btn, .audio-btn {
                width: 42px;
                height: 42px;
                font-size: 18px;
            }

            .logo-container {
                top: 10px;
                left: 10px;
            }

            .logo {
                padding: 8px 12px;
            }

            .logo-text .name {
                font-size: 12px;
            }

            .logo-text .tagline {
                display: none;
            }
        }

        #chatInput{
        padding: 20px;
        width: 80%;
        border-radius: 20px;
        border: 0.8px solid ;
        }
    </style>
</head>
<body>
    <!-- Logo Top Left -->
    <div class="logo-container">
        <div class="logo">
            <div class="logo-icon">ðŸ¤–</div>
            <div class="logo-text">
                <div class="name">OMAR CHAOUKAT</div>
                <div class="tagline">AI Assistant</div>
            </div>
        </div>
    </div>

    <!-- Welcome Message -->
   

    <!-- Animated Avatar -->
    <div class="avatar-container" id="avatar">
        <div class="avatar">
            <div class="avatar-circle">
                <div class="avatar-face">
                    <img src="https://media.licdn.com/dms/image/v2/D4E03AQEMeFfMLS4vJA/profile-displayphoto-scale_400_400/B4EZjuLXTzHoAk-/0/1756342614477?e=2147483647&v=beta&t=h3G7lRxf0btNpAU_dw0OHRhinpazAw1YDEI89QHpD7w" width="100%" height="100%" alt="">
                </div>
            </div>
            <div class="voice-waves">
                <div class="wave"></div>
                <div class="wave"></div>
                <div class="wave"></div>
                <div class="wave"></div>
                <div class="wave"></div>
            </div>
        </div>
    </div>

    <!-- Chat Container -->
    <div class="chat-container">
        <div class="chat-header">
            <div class="chat-header-avatar">ðŸ¤–</div>
            <div class="chat-header-info">
                <h2>OMAR CHAOUKAT AI</h2>
                <p>Your intelligent assistant</p>
            </div>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="message assistant">
                <div class="message-avatar">ðŸ¤–</div>
                <div class="message-content">
                  Bonjour je suis Omar chaoukat comment je peux vous aidez
                </div>
            </div>
        </div>

        <div class="chat-input-container">
            <input type="text" class="chat-input" id="chatInput" placeholder="Type your message...">
            <!-- file button + hidden input -->
            <input type="file" id="fileInput" class="file-input-hidden" />
            <button class="file-btn" id="fileBtn" title="Upload File">ðŸ“Ž</button>
            <button class="send-btn" id="sendBtn" title="Send Message">âž¤</button>
        </div>
    </div>

    <script>
        // Dummy responses about Omar Chaoukat
        const dummyResponses = [
            "Omar Chaoukat is a talented developer with expertise in AI and web technologies! ðŸš€",
            "I'm here to assist you with anything related to Omar's projects and skills.",
            "Omar specializes in creating innovative solutions using cutting-edge technologies.",
            "Did you know? Omar is passionate about building AI-powered applications! ðŸ¤–",
            "Omar has extensive experience in full-stack development, from frontend to backend.",
            "I can help you learn more about Omar's portfolio and achievements!",
            "Omar is always exploring new technologies and pushing the boundaries of what's possible.",
            "Feel free to ask me anything about Omar's work, skills, or projects! ðŸ’¡",
            "Omar combines creativity with technical expertise to build amazing applications.",
            "I'm powered by Omar's innovative approach to AI and software development! âœ¨"
        ];

        // DOM Elements
        const avatar = document.getElementById('avatar');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const audioBtn = document.getElementById('audioBtn');
        const fileBtn = document.getElementById('fileBtn');
        const fileInput = document.getElementById('fileInput');

        let isRecording = false;
        let recognition = null;

        // Initialize Speech Recognition
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                chatInput.value = transcript;
                isRecording = false;
                audioBtn.classList.remove('recording');
            };

            recognition.onerror = () => {
                isRecording = false;
                audioBtn.classList.remove('recording');
            };

            recognition.onend = () => {
                isRecording = false;
                audioBtn.classList.remove('recording');
            };
        }

        // Position avatar randomly on load
        function positionAvatarRandomly() {
            const maxX = window.innerWidth - 150;
            const maxY = window.innerHeight - 150;
            const randomX = Math.floor(Math.random() * maxX);
            const randomY = Math.floor(Math.random() * maxY);
            
            avatar.style.left = randomX + 'px';
            avatar.style.top = randomY + 'px';
        }

        // Initial random position
        positionAvatarRandomly();

        // Add message to chat
        function addMessage(text, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const avatarDiv = document.createElement('div');
            avatarDiv.className = 'message-avatar';
            avatarDiv.textContent = type === 'user' ? 'ðŸ‘¤' : 'ðŸ¤–';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.innerHTML = text;
            
            messageDiv.appendChild(avatarDiv);
            messageDiv.appendChild(contentDiv);
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Show typing indicator
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message assistant';
            typingDiv.id = 'typingIndicator';
            
            const avatarDiv = document.createElement('div');
            avatarDiv.className = 'message-avatar';
            avatarDiv.textContent = 'ðŸ¤–';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content typing-indicator';
            contentDiv.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
            
            typingDiv.appendChild(avatarDiv);
            typingDiv.appendChild(contentDiv);
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Remove typing indicator
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Animate avatar (talking animation)
        function animateAvatar(duration = 2000) {
            // Show avatar
            avatar.classList.add('show');
            avatar.classList.add('avatar-talking');
            
            // Move avatar to new random position
            positionAvatarRandomly();
            
            setTimeout(() => {
                avatar.classList.remove('avatar-talking');
                // Hide avatar after response
                setTimeout(() => {
                    avatar.classList.remove('show');
                }, 500);
            }, duration);
        }

        // Speak text (Text-to-Speech)
        function speak(text) {
        if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);

        // Find voices AFTER they load
        const voices = speechSynthesis.getVoices();

        // Try to pick a male voice
        const maleVoice =
            voices.find(v => v.name.toLowerCase().includes("male")) ||
            voices.find(v => v.name.toLowerCase().includes("daniel")) || // UK male
            voices.find(v => v.name.toLowerCase().includes("fred")) ||   // US male
            voices.find(v => v.lang === "en-US") ||                      // fallback
            voices[0];                                                   // final fallback

        utterance.voice = maleVoice;
        utterance.rate = 1.5;
        utterance.pitch = 1.0;
        utterance.volume = 1.0;

        speechSynthesis.speak(utterance);
    }
        }

   



   const chars = [
  // Alphabet minuscule
  ..."abcdefghijklmnopqrstuvwxyz",

  // Alphabet majuscule
  ..."ABCDEFGHIJKLMNOPQRSTUVWXYZ",

  // Chiffres
  ..."0123456789",

  // CaractÃ¨res spÃ©ciaux
  ..."!@#$%^&*()-_=+[]{};:'\",.<>/?\\|`~"
];




function AddSession(){
   let sessionId="";
   let random;
   let finalSession;

   /**/
    if(localStorage.getItem("sessionChAgent")==null){
          
          for(let i=0;i<20;i++){

            random=_.random(0,chars.length-1);
            sessionId=sessionId+chars[random];
        
        }
             localStorage.setItem("sessionChAgent",sessionId)  ;  
             finalSession=sessionId
    }else{
          finalSession=localStorage.getItem("sessionChAgent") ;        
    }


    return finalSession;
}






        // Handle sending message
        function sendMessage() {
            const message = chatInput.value.trim();
            
            if (!message) return;
            
 addMessage(message, 'user');
  chatInput.value = '';



  showTypingIndicator();

            fetch(`https://agencyv.app.n8n.cloud/webhook/user?response=${message}&sessionkey=${AddSession()}`)
            .then(res=>res.json())
            .then(data=>{
            
           
            
            // Show typing indicator
           
            let response;
            // Simulate response delay
            setTimeout(() => {
                removeTypingIndicator();
                console.log(data)
                 response= data.nodeOutput?data.nodeOutput:"Sorry something went Wrong";
                 
                addMessage(response, 'assistant');
           
              
             
                
                // Show and animate avatar during response
                animateAvatar(response.length * 50);
                speak(response);
                  
            }, 1000 + Math.random() * 2000);
              
            })
            // Add user message
           
        }

        // Event Listeners
        sendBtn.addEventListener('click', sendMessage);

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

       

        // File upload button opens file picker
        fileBtn.addEventListener('click', () => {
            fileInput.value = ''; // reset selection
            fileInput.click();
        });
        
        // When a file is selected upload it to n8n and show conversation messages
        fileInput.addEventListener('change', async (e) => {
            const file = e.target.files && e.target.files[0];
            if (!file) return;

            // Show user message with file name
            
             

            try {
                const result = await uploadFileToN8N(file);
  addMessage(result.nodeOutput,"assistant")

            } catch (err) {
                alert("sorry something went wrong");
            }
        });

        // Drag functionality for avatar
        let isDragging = false;
        let dragStartX = 0;
        let dragStartY = 0;
        let avatarStartX = 0;
        let avatarStartY = 0;
        let hasMoved = false;

        avatar.addEventListener('mousedown', (e) => {
            if (!avatar.classList.contains('show')) return;
            
            isDragging = true;
            hasMoved = false;
            avatar.classList.add('dragging');
            
            dragStartX = e.clientX;
            dragStartY = e.clientY;
            
            const rect = avatar.getBoundingClientRect();
            avatarStartX = rect.left;
            avatarStartY = rect.top;
            
            e.preventDefault();
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            
            const deltaX = e.clientX - dragStartX;
            const deltaY = e.clientY - dragStartY;
            
            // Check if user has moved more than 5px (to distinguish click from drag)
            if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {
                hasMoved = true;
            }
            
            let newX = avatarStartX + deltaX;
            let newY = avatarStartY + deltaY;
            
            // Keep avatar within viewport bounds
            const maxX = window.innerWidth - 150;
            const maxY = window.innerHeight - 150;
            
            newX = Math.max(0, Math.min(newX, maxX));
            newY = Math.max(0, Math.min(newY, maxY));
            
            avatar.style.left = newX + 'px';
            avatar.style.top = newY + 'px';
        });

        document.addEventListener('mouseup', () => {
            if (!isDragging) return;
            
            isDragging = false;
            avatar.classList.remove('dragging');
            
            // If it was just a click (not dragged), trigger greeting
            if (!hasMoved && avatar.classList.contains('show')) {
                const greeting = "Bonjour je suis omar chaoukaty . comment je peux vous aider";
                animateAvatar(greeting.length * 50);
                speak(greeting);
            }
        });

        // Touch support for mobile devices
        avatar.addEventListener('touchstart', (e) => {
            if (!avatar.classList.contains('show')) return;
            
            isDragging = true;
            hasMoved = false;
            avatar.classList.add('dragging');
            
            const touch = e.touches[0];
            dragStartX = touch.clientX;
            dragStartY = touch.clientY;
            
            const rect = avatar.getBoundingClientRect();
            avatarStartX = rect.left;
            avatarStartY = rect.top;
            
            e.preventDefault();
        });

        document.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            
            const touch = e.touches[0];
            const deltaX = touch.clientX - dragStartX;
            const deltaY = touch.clientY - dragStartY;
            
            if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {
                hasMoved = true;
            }
            
            let newX = avatarStartX + deltaX;
            let newY = avatarStartY + deltaY;
            
            const maxX = window.innerWidth - 150;
            const maxY = window.innerHeight - 150;
            
            newX = Math.max(0, Math.min(newX, maxX));
            newY = Math.max(0, Math.min(newY, maxY));
            
            avatar.style.left = newX + 'px';
            avatar.style.top = newY + 'px';
        });

        document.addEventListener('touchend', () => {
            if (!isDragging) return;
            
            isDragging = false;
            avatar.classList.remove('dragging');
            
            if (!hasMoved && avatar.classList.contains('show')) {
                const greeting = "Bonjour je suis omar chaoukat , Comment je peux vous aider";
                animateAvatar(greeting.length * 50);
                speak(greeting);
            }
        });

        // Create floating particles
        function createParticles() {
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (10 + Math.random() * 10) + 's';
                document.body.appendChild(particle);
            }
        }

        createParticles();

        // Welcome speech
      
 async function send() {
    const file = document.getElementById("fileInput").files[0];
    if (!file) return alert("Choose a file first!");

    const result = await uploadFileToN8N(file);
    console.log(result);
    
  }




        async function uploadFileToN8N(file) {
  const url = "https://agencyv.app.n8n.cloud/webhook/user";

  // Create the multipart/form-data payload
  const formData = new FormData();
  formData.append("file", file); // The field name MUST be "file"

  try {
    const response = await fetch(url, {
      method: "POST",
      body: formData,
      headers: {
        // DO NOT manually set Content-Type here
        // fetch will generate the correct multipart boundary automatically
      },
    });

    if (!response.ok) {
      throw new Error(`Upload failed: ${response.statusText}`);
    }

    const result = await response.json();
    console.log("File uploaded successfully:", result);
    return result;

  } catch (error) {
    console.error("Upload error:", error);
    throw error;
  }
}

    </script>
</body>
</html>
